---
title: Solución ropemporium split
date: 2024-01-06
categories: [rop, 64bits, bof]
tags: [64bits, bof, rop] #minúsculas-
---
# split

En el título del challenge nos dice el siguiente:

The elements that allowed you to complete ret2win are still present, they've just been split apart.
Find them and recombine them using a short ROP chain.

Así que estaremos haciendo otro ret2win.

Empezamos con las protecciones que tiene, tenemos NX activado que es data execution prevention una protección, cuya finalidad es no permitirnos ejecutar instrucciones a bajo nivel.

![](/assets/img/rop/checksec.png)

Si ejecutamos el binario podemos ver que nos pide un input.

![](/assets/img/rop/split.png)

Creamos un pattern con cyclic.
![](/assets/img/rop/cyclic.png)

Como vemos se acontece un desbordamiento de buffer, vemos que el offset es de 40 bytes.
![](/assets/img/rop/offset.png)

Como en el challenge sabemos que tenemos que hacer un call a la dirección que hace /bin/cat flag.txt, buscaremos con rabin2 los strings, así podemos sacar la dirección de memoria.
![](/assets/img/rop/flag.png)
Necesitamos sacar la dirección de system también para eso usamos objdump de la siguiente forma.
![](/assets/img/rop/objdump.png)

Ahora nos queda encontrar pop rdi; ret y ret para eso usaremos ROPgadget.
![](/assets/img/rop/pop%20rdi%20ret.png)

Ya tenemos todo lo necesario para poder leer la flag.

# Exploit

![](/assets/img/rop/splitexploit.png)